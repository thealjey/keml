<form
  on:submit="saveSettings"
  on:result="redirect-{increment(True)}"
  if:invalid="formInvalid"
  on="saveSettings"
  error="submitErrors"
  result="updatedForm"
  render="updatedForm"
  position="replaceWith"
  method="post"
>
  <fieldset
    on="redirect-{increment()}"
    src="{url('profile', slug=user.user_slug)}"
    redirect="replaceState"
  >
    <fieldset class="form-group">
      <input
        if:invalid="urlInvalid"
        class="form-control"
        type="url"
        placeholder="URL of profile picture"
        autocomplete="url"
        title="Leaving this field blank will generate a gravatar url based on your email address."
        value="{user.avatar}"
        name="avatar"
      >
    </fieldset>
    <fieldset class="form-group">
      <input
        class="form-control form-control-lg"
        type="text"
        placeholder="Your Name"
        autocomplete="name"
        title="Leaving this field blank will keep your current username unchanged."
        value="{user.username}"
        name="username"
      >
    </fieldset>
    <fieldset class="form-group">
      <textarea
        class="form-control form-control-lg"
        rows="8"
        placeholder="Short bio about you"
        title="Leaving this field blank will erase your bio."
        name="bio"
      >
        {user.bio}
      </textarea>
    </fieldset>
    <fieldset class="form-group">
      <input
        if:invalid="emailInvalid"
        class="form-control form-control-lg"
        type="email"
        placeholder="Email"
        autocomplete="email"
        title="Leaving this field blank will keep your current email unchanged."
        value="{user.email}"
        name="email"
      >
    </fieldset>
    <fieldset class="form-group">
      <input
        if:invalid="passwordInvalid"
        class="form-control form-control-lg"
        type="password"
        minlength="5"
        placeholder="New Password"
        autocomplete="new-password"
        title="Leaving this field blank will keep your current password unchanged."
        name="password"
      >
    </fieldset>
    <button
      if="formInvalid"
      x-disabled
      class="btn btn-lg btn-primary pull-xs-right"
    >
      Update Settings
    </button>
  </fieldset>
</form>
