/*!
 * keml v3.2.4 - Enhance HTML with custom attributes for clean, server-driven interactivity.
 *
 * Docs:  https://thealjey.github.io/keml/
 * Repo:  https://github.com/thealjey/keml/
 * NPM:   https://www.npmjs.com/package/keml/
 *
 * Licensed under the MIT License. See LICENSE file for details.
 */
"use strict";(()=>{var v=e=>{let t=[],r=e.length,n=0,o=-1;for(;n<r;++n)e.charCodeAt(n)===32?o!==-1&&(t.push(e.slice(o,n)),o=-1):o===-1&&(o=n);return o!==-1&&t.push(e.slice(o,n)),t};var Q=e=>{let t=Array.from(e.attributes),r=t.length;for(let n=0,o,a,s,c,i,d;n<r;++n){for(a=t[n],s=a.name,c=a.value,d=s.slice(2),o=0;o<r&&(i=t[o],i.name!==d);++o)i=void 0;s.startsWith("x-")?i?(a.value=i.value,i.value=c):(e.removeAttributeNode(a),e.setAttribute("d-"+d,""),e.setAttribute(d,c)):s.startsWith("d-")&&(i&&(e.setAttribute("x-"+d,i.value),e.removeAttributeNode(i)),e.removeAttributeNode(a))}},V=e=>{e.hasAttribute("state")||(Q(e),e.setAttribute("state",""))},N=e=>{let t=e.getAttributeNode("state");t&&(e.removeAttributeNode(t),Q(e))};var R=(e,t,r)=>{if(t.nodeName==r.nodeName){if(t.nodeValue!=r.nodeValue&&(t.nodeValue=r.nodeValue),t.value!=r.value&&(t.value=r.value),t.checked!=r.checked&&(t.checked=r.checked),t instanceof Element){N(t);let n=t.attributes,o=n.length,a,s,c,i;for(;o--;)s=n[o],r.hasAttribute(s.name)||t.removeAttributeNode(s);for(n=r.attributes,o=0,a=n.length;o<a;++o)s=n[o],c=s.name,i=s.value,(s=t.getAttributeNode(c))?s.value!=i&&(s.value=i):t.setAttribute(c,i);B(t,Array.from(r.childNodes))}}else e.replaceChild(r,t)},D=(e,t)=>{let r=e.parentNode,n=t.length;if(n){let o=0,a;for(;o<n&&(a=t[o],!(a.nodeName==e.nodeName&&a.getAttribute?.("key")==e.getAttribute("key")));++o)a=void 0;a?(o&&e.before.apply(e,t.slice(0,o)),++o<n&&e.after.apply(e,t.slice(o)),R(r,e,a)):(n>1&&e.after.apply(e,t.slice(1)),R(r,e,t[0]))}else r.removeChild(e)},B=(e,t)=>{let r=e.childNodes,n=t.length,o=r.length,a=0,s,c,i;for(;a<n;++a){for(s=t[a],c=a,i=void 0;c<o&&(i=r[c],!(s.nodeName==i.nodeName&&s.getAttribute?.("key")==i.getAttribute?.("key")));++c)i=void 0;i?(c!==a&&e.insertBefore(i,r[a]),R(e,r[a],s)):a<o++?e.insertBefore(s,r[a]):e.appendChild(s)}for(;o>n;)e.removeChild(r[--o])};var b=new Set,h=new Set,E=new Set,x=new Set,g=new Set,A=new Set,M=[],L=[];var Y=[],Z=new Event("result"),X=[],w=!0,U=e=>X.push(e.target),f=()=>{w=!0},S=()=>{let e,t,r,n,o,a,s,c,i,d,u,l,m,p;for(;e=M.pop();)e.reset?.();for(;e=L.pop();)e.removeAttribute("on");for(;r=X.pop();){if(a=r.responseXML,e=r.s,o=void 0,(e.o=r.status>399)?(n=e.getAttributeNode("error"))&&(o=v(n.value)):(n=e.getAttributeNode("result"))&&(o=v(n.value)),o){u=!1,c=a?Array.from(a.body.childNodes):Y,p=[];for(t of g)if(o.includes(t.getAttribute("render"))){if(u)for(s=[],i=0,d=c.length;i<d;++i)s.push(c[i].cloneNode(!0));else s=c;p.push(t,s),u=!0}for(;s=p.pop();)t=p.pop(),(n=t.getAttributeNode("position"))?(l=n.value,l==="after"?t.after.apply(t,s):l==="append"?t.append.apply(t,s):l==="before"?t.before.apply(t,s):l==="prepend"?t.prepend.apply(t,s):l==="replaceWith"?D(t,s):B(t,s)):B(t,s)}e.r=!1,w=!0,e.o||e.dispatchEvent(Z)}if(w){w=!1,o=[];for(e of h)e.checkValidity&&(n=e.getAttributeNode("if:invalid"))&&!e.checkValidity()&&o.push.apply(o,v(n.value)),(e instanceof HTMLInputElement?e.type==="checkbox"?e.checked:e.value:(e instanceof HTMLSelectElement||e instanceof HTMLTextAreaElement)&&e.value)&&(n=e.getAttributeNode("if:value"))&&o.push.apply(o,v(n.value)),(n=e.getAttributeNode("if:intersects"))&&(m=e.getBoundingClientRect(),m.bottom>-1&&m.right>-1&&m.left<=innerWidth&&m.top<=innerHeight&&o.push.apply(o,v(n.value))),e.r&&(n=e.getAttributeNode("if:loading"))&&o.push.apply(o,v(n.value)),e.o&&(n=e.getAttributeNode("if:error"))&&o.push.apply(o,v(n.value));for(e of A)o.includes(e.getAttribute("if"))?V(e):N(e)}requestAnimationFrame(S)};var ee=new Event("reveal"),te=new Event("conceal"),ne=e=>{let t=e.length;for(let r=0,n;r<t;++r)n=e[r],n.isIntersecting&&n.target.dispatchEvent(ee)},oe=e=>{let t=e.length;for(let r=0,n;r<t;++r)n=e[r],n.isIntersecting||n.target.dispatchEvent(te)},C=new IntersectionObserver(ne),H=new IntersectionObserver(oe),T=new IntersectionObserver(f);var re=new Event("navigate"),k=()=>{for(let e of x)e.dispatchEvent(re)};var P=document.createElement("form"),F=Object.create(null),y=(e,t)=>{if(e)for(let r of e)typeof r[1]=="string"&&t.searchParams.append(r[0],r[1])},O=e=>{if(clearTimeout(e.n),e.n=void 0,!e.checkValidity||e.checkValidity()){e.hasAttribute("once")&&L.push(e);let t,r,n,o="",a="GET";(t=e.getAttributeNode("get"))?o=t.value:(t=e.getAttributeNode("post"))?(o=t.value,a="POST"):(t=e.getAttributeNode("put"))?(o=t.value,a="PUT"):(t=e.getAttributeNode("delete"))?(o=t.value,a="DELETE"):((t=e.getAttributeNode("href"))||(t=e.getAttributeNode("action"))||(t=e.getAttributeNode("src")))&&(o=t.value),(t=e.getAttributeNode("method"))&&(a=t.value.toUpperCase());let s=new URL(o,e.baseURI),c=s.pathname,i,d,u;for(r=c.length;r--&&c.charCodeAt(r)===47;);if(r!==-1){for(i=r-c.length+1;r--&&(d=c.charCodeAt(r),d!==47);)if(d===46){u=!0;break}u?i<0&&(s.pathname=c.slice(0,i)):i===0?s.pathname=c+"/":i<-1&&(s.pathname=c.slice(0,i+1))}let l;e instanceof HTMLFormElement?l=new FormData(e):e instanceof HTMLInputElement||e instanceof HTMLSelectElement||e instanceof HTMLTextAreaElement?(P.replaceChildren(e.cloneNode(!0)),l=new FormData(P)):(t=e.getAttributeNode("name"))&&(n=t.value,(t=e.getAttributeNode("value"))&&(l=new FormData,l.set(n,t.value)));let m=e.getAttribute("redirect");if(m==="pushState")y(l,s),history.pushState(F,"",s),k();else if(m==="replaceState")y(l,s),history.replaceState(F,"",s),k();else if(m==="assign")y(l,s),location.assign(s);else if(m==="replace")y(l,s),location.replace(s);else{let p=new XMLHttpRequest,W=e.attributes,J=W.length;for(a!=="POST"&&(y(l,s),l=void 0),p.responseType="document",p.withCredentials=e.hasAttribute("credentials"),p.s=e,p.onloadend=U,p.open(a,s),p.setRequestHeader("X-Requested-With","XMLHttpRequest"),r=0;r<J;++r)t=W[r],n=t.name,n.startsWith("h-")&&p.setRequestHeader(n.slice(2),t.value);e.o=!1,e.r=!0,f(),p.send(l)}}};var j=e=>{let t=e.target;if(t instanceof Element){let r=e.type,n=t,o,a=`on:${r}`;for(;n&&!(o=n.getAttributeNode(a));)n=n.parentElement;if(n&&o){let s=v(o.value);if(s.length){if(o=n.getAttributeNode(`event:${r}`)){let c=o.value.split(","),i=c.length;for(let d=0,u,l;d<i;++d)if(u=c[d],l=u.indexOf("="),l===-1){if(r=u.trim(),r&&!e[r])return}else if(r=u.slice(0,l).trim(),r&&e[r]+""!==u.slice(l+1).trim())return}e.preventDefault();for(n of b)s.includes(n.getAttribute("on"))&&((o=n.getAttributeNode("throttle"))?n.n??=setTimeout(O,+o.value,n):(o=n.getAttributeNode("debounce"))?(clearTimeout(n.n),n.n=setTimeout(O,+o.value,n)):O(n));for(n of E)s.includes(n.getAttribute("reset"))&&M.push(n)}}}};var z=[],q={a:{e(e,t){t==="on:navigate"?x.add(e):t==="on:reveal"?C.observe(e):t==="on:conceal"&&H.observe(e),z.includes(t)||(z.push(t),document.addEventListener(t.slice(3),j,!0))},t(e,t){t==="on:navigate"?x.delete(e):t==="on:reveal"?C.unobserve(e):t==="on:conceal"&&H.unobserve(e)}},i:{e(e,t){h.add(e),t==="if:intersects"&&T.observe(e)},t(e,t){h.delete(e),t==="if:intersects"&&T.unobserve(e)}},on:{e(e){b.add(e)},t(e){b.delete(e)}},if:{e(e){A.add(e)},t(e){A.delete(e)}},reset:{e(e){E.add(e)},t(e){E.delete(e)}},render:{e(e){g.add(e)},t(e){g.delete(e)}},autofocus:{e(e){try{let t=e.value.length;e.focus(),e.setSelectionRange(t,t)}catch{}},t(){}}},K=e=>{b.delete(e),A.delete(e),x.delete(e),g.delete(e),E.delete(e),h.delete(e),H.unobserve(e),T.unobserve(e),C.unobserve(e)},I=e=>e.startsWith("on:")?q.a:e.startsWith("if:")?q.i:q[e];var _=(e,t)=>{let r=e.length;for(let n=0,o,a,s,c,i,d,u;n<r;++n)if(c=e[n],c instanceof Element){a=document.createTreeWalker(c,NodeFilter.SHOW_ELEMENT);do if(i=a.currentNode,t)for(o=0,u=i.attributes,d=u.length;o<d;++o)s=u[o].name,I(s)?.e(i,s);else K(i);while(a.nextNode())}};var $=e=>{let t=e.length;for(let r=0,n,o,a,s;r<t;++r)n=e[r],o=n.attributeName,a=n.target,_(n.removedNodes,!1),_(n.addedNodes,!0),o&&a instanceof Element&&(s=I(o),s&&(a.hasAttribute(o)?n.oldValue==null&&s.e(a,o):n.oldValue!=null&&s.t(a,o)));f()};var G=()=>{try{document.cookie=`tzo=${new Date().getTimezoneOffset()};Path=/;SameSite=lax;Max-Age=31536000`}catch{}_(document.childNodes,!0),new MutationObserver($).observe(document,{attributeOldValue:!0,attributes:!0,childList:!0,subtree:!0}),document.addEventListener("change",f,!0),document.addEventListener("input",f,!0),document.addEventListener("reset",f,!0),window.addEventListener("popstate",k,!0),requestAnimationFrame(S)};document.addEventListener("DOMContentLoaded",G,!0);})();
